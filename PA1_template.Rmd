---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data

Read data file using read.csv() function, then convert to data table.

```{r loaddata}
library(data.table)
library(ggplot2)

dt_act<-data.table(read.csv("activity.csv"))


```

## What is mean total number of steps taken per day?


First we calculate the total number of steps per day, then get the summary of the totoal steps.
```{r }

dt_totalsteps<-dt_act[,sum(steps,na.rm = TRUE),by=date]

names(dt_totalsteps)<-c("date","total_steps")

data_summary<-summary(dt_totalsteps$total_steps)
print(data_summary)
```
The mean value of total steps per day is `r data_summary[4]` and the median value of total  steps per day is `r format(data_summary[3],scientific=FALSE)`


Here is the histogram of total steps per day

```{r  warning=FALSE}
hist_totalsteps<-ggplot(data=dt_totalsteps,aes(total_steps))
hist_totalsteps<-hist_totalsteps+geom_histogram()+xlab("total steps")
hist_totalsteps<-hist_totalsteps+ggtitle("Total steps per day")
print(hist_totalsteps)

```

## What is the average daily activity pattern?

We first calculate the average

```{r  warning=FALSE}


dt_act[,step_mean:=mean(steps,na.rm=TRUE),by=interval]

g<-ggplot(data=dt_act,aes(interval,step_mean))
g<-g+geom_line()+ylab("Average steps")
print(g)
```


## Imputing missing values

```{r warning=FALSE, results="hide" }
dt_act[,old_steps:=steps]

dt_act[,steps:=replace(steps,is.na(steps),step_mean)]
```

## Are there differences in activity patterns between weekdays and weekends?
